# Current Task

## 진행 중인 작업

### 2026-01-04: **홈 화면 '오늘의 일정' 필터 수정 및 절기 클릭 비활성화 ✅**

#### 1. 오늘의 일정 필터링
- 홈 화면의 '오늘의 일정' 섹션에서 이번주 일정이 모두 표시되는 문제 수정
- `오늘 이후의 일정` → `오늘 일정만` 필터링으로 변경
- 수정 파일: `App.tsx` (line 381-386)

#### 2. 24절기 클릭 비활성화
- 캘린더에서 절기(대한, 소한 등)를 클릭해도 상세 모달이 열리지 않도록 수정
- 절기는 캘린더 내에만 표시되고 클릭 불가능하게 처리
- 수정 파일: `WeekCalendar.tsx` (line 177-186)

#### 3. 홈 화면 인사말 번갈아 나타나는 문제 수정
- Supabase에서 설정한 최신 값만 표시되도록 수정
- appConfig가 로드되기 전까지는 인사말을 표시하지 않음
- 기본값(constants.ts)과 DB값이 번갈아 나타나는 현상 해결
- 수정 파일: `App.tsx` (line 333-343)

---

## 이전 작업

### 2025-12-31: **법문 텍스트 자동화 시스템 구축 🤖**

#### 1단계: 부족한 텍스트 수집 (진행 중)
**목표:** dhamma.kr에서 빠진 법문 텍스트 파일 모두 수집

**현재 상태:**
- 📂 수집된 텍스트: 1,995개 파일
- 📡 현재 페이지: 1,000 / 3,368 (30% 완료)
- 🔄 백그라운드에서 계속 수집 중...

---

#### 2단계: ElevenLabs TTS 음성 변환 (진행 중)
**목표:** 수집한 텍스트를 음성 파일(MP3)로 변환

**테스트 완료:**
- ✅ 짧은 법문 테스트: 송구영신.txt → 72KB MP3
- ✅ 긴 법문 테스트: 잡아함 110 살차경.txt (9,532글자) → 21.39 MB MP3
- ✅ 변환 품질 확인 완료

**생성된 스크립트:**
- ✅ `/scripts/txt_to_mp3.py` - 단일 파일 변환
- ✅ `/scripts/batch_convert_all.py` - 일괄 변환 (NEW!)

**일괄 변환 기능:**
- 이미 변환된 파일 자동 건너뛰기
- 진행 상황 실시간 표시
- 에러 처리 및 재시도
- 중단 후 재개 가능

**예상 소요:**
- 파일 수: 약 1,300개
- 예상 시간: 약 21시간 (파일당 1분)
- ElevenLabs 크레딧 보유 확인됨

**실행 명령:**
```bash
export ELEVENLABS_API_KEY='sk_c4731a145399a454e1f988028b3b3a5e8f7abb65e948dcf9'
python3 /Users/jinseulpark/Desktop/github/jsks_app/scripts/batch_convert_all.py
```

---

#### 3단계: Google Drive 업로드 (대기 중)
**목표:** 변환된 MP3를 Google Drive에 자동 업로드

**필요한 작업:**
1. Google Drive API 설정
2. 업로드 스크립트 작성
3. Supabase DB에 Drive URL 저장

---

#### 4단계: GitHub Actions 자동화 (대기 중)
**목표:** 매일 자동으로 새 법문 수집 및 음성 변환

**계획:**
- GitHub Actions 워크플로우 생성
- 매일 정해진 시간에 자동 실행
- 새 txt → MP3 변환 → Google Drive 업로드
- DB 자동 업데이트

---

## 상세 보고

### 텍스트 수집 현황
```
📊 통계:
- 전체 페이지: 3,368 페이지
- 현재 진행: 1,000 페이지 (30%)
- 수집 완료: 1,995개 파일
- 실패: 1개만
- 저장 위치: /scraper/texts/
- 진행 상황: /scraper/progress.json
```

### 음성 변환 테스트 결과
```
📊 테스트 파일:
1. 송구영신.txt (38글자)
   → 송구영신.mp3 (72KB)

2. 잡아함 110 살차경.txt (9,532글자)
   → 잡아함 110 살차경.mp3 (21.39MB)

✅ 한국어 발음: 정상
✅ 전처리: 한자/괄호 제거 작동
✅ 음질: 양호
```

### 다음 작업
1. ⏳ **텍스트 수집 완료 대기** (백그라운드 진행 중)
2. 🚀 **일괄 음성 변환 시작 가능** (준비 완료)
3. ⏳ **Google Drive 업로드 준비**

---

## 완료된 작업
- 2025-12-31: **절기 팝업 제거 및 통일 ✅**
  - ✅ 홈 화면에서 절기/행사 일정 목록 제외
  - ✅ '절기/행사'와 '절기' 태그를 '절기'로 통일
  - ✅ 홈 화면에는 정수사의 실제 행사만 표시
  - ✅ 앱 버전 1.0.5로 업데이트 및 배포
  - ✅ 업데이트된 파일:
    - `App.tsx` - 절기 필터링 및 태그 통일
    - `ScheduleList.tsx` - 절기 삭제 불가 처리
  - ✅ Vercel 프로덕션 배포 완료
